# Network Security - PoC

## SNI Evasion
If you don't want to run the PoC, the `sni.pcap` file contains the traffic captured during the PoC, which you can analyze using `snort` (see command in the section below).

- The snort rules are in the `snort_block_sni.rule` file.
- The `certs` directory contains the self-signed certificate (domain: `bad.com`) used for the QUIC and TCP servers.

### Running the PoC
To start the topology, run the following command:
```bash
sudo python3 topo.py
```
It will launch 3 xterm windows:
1. **serverTCP**: This is the TCP server that will handle incoming connections.
2. **serverHTTP3**: This is the HTTP/3 (QUIC) server that will handle HTTP/3 requests.
3. **Firewall**: This is the firewall that should be running the IDS, in this case I wasn't able to make `snort` running in mininet, so the firewall start `tcpdump` to capture traffic in a pcap, that we could then analyze using `snort`.

First we have to add the `bad.com` hostname to the `/etc/hosts` file of the `client`, so that it can resolve it correctly (since we don't have a DNS server in this topology):
```bash
client echo "10.0.1.2 bad.com" >> /etc/hosts
```


Then we make the request to the HTTP/3 server using the client:
```bash
client python3 http3_client.py https://bad.com --ca-certs certs/cert.pem # --output-dir output_dirs
```

We have to change the `/etc/hosts` to redirect `bad.com` to `serverTCP` IP address (10.0.1.3). And make the request to the TCP server:
```bash
client wget --no-check-certificate https://bad.com
```

And finally, we can analyze the traffic captured by the firewall using `snort`:
```bash
# snort 2.x
sudo snort -k none -l . -c snort_block_sni.rule -r tcpdump.pcap
```
The results should appear in a file called `alert` in the current directory, which will contain the alerts generated by `snort`.